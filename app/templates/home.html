{% extends "layout.html" %}
{% block head_extra %}
    <link rel="stylesheet" href="/static/css/site_styles.css">
{% endblock %}

{% block content %}
<!-- <h1>Home</h1> -->
{% if session.get('user') %}
<h6>Username : {{ userId }}</h6>


<style>
    .grid-container {
        display: grid;
        grid-template-columns: 1fr 1fr; 
        gap: 20px;
        height: auto;
    }
    .grid-item {
        border: 1px solid #ccc;
        padding: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 250px; 
    }
    #myChart {
        width: 100% !important;
        height: 100% !important;
    }

    @media (max-width: 768px) {
        .grid-container {
            grid-template-columns: 1fr; 
        }
    }
</style>

<div class="grid-container">
    <div class="grid-item">
        <canvas id="myChart"></canvas>
    </div>

    <div class="grid-item">
        <div style="width: 100%; padding: 10px;">
            <h3 style="margin: 0 0 20px 0; text-align: center; color: #333;">ðŸ’° Wallet Balances</h3>
            {% if wallets and wallets|length > 0 %}
                <div style="display: flex; flex-direction: column; gap: 12px; max-height: 200px; overflow-y: auto;">
                    {% for wallet in wallets %}
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 16px; background: linear-gradient(135deg, #f8f9fa, #e9ecef); border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                        <div style="font-weight: 600; color: #495057;">{{ wallet.walletName or wallet.walletId }}</div>
                        <div style="font-size: 1.1rem; font-weight: 700; {% if wallet.balance >= 0 %}color: #28a745;{% else %}color: #dc3545;{% endif %}">
                            {% if wallet.balance >= 0 %}+{% endif %}â‚¬{{ '%.2f'|format(wallet.balance) }}
                        </div>
                    </div>
                    {% endfor %}
                </div>
            {% else %}
                <p style="text-align: center; color: #6c757d; font-style: italic;">No wallets found</p>
            {% endif %}
        </div>
    </div>

    <div class="grid-item">
        <p>Section 3 content here</p>
    </div>


    <div class="grid-item">
        <p>Section 4 content here</p>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const labels = {{ cryptoLabels | tojson }};
    const data = {{ cryptoValues | tojson }};

    new Chart(document.getElementById('myChart'), {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [{
                label: 'Total Cryptos',
                data: data,
                backgroundColor: [
                    'rgba(255, 99, 132, 0.5)',
                    'rgba(54, 162, 235, 0.5)',
                    'rgba(255, 206, 86, 0.5)',
                    'rgba(75, 192, 192, 0.5)',
                    'rgba(153, 102, 255, 0.5)'
                ],
                borderColor: [
                    'rgba(255, 99, 132, 1)',
                    'rgba(54, 162, 235, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(75, 192, 192, 1)',
                    'rgba(153, 102, 255, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                y: { beginAtZero: true }
            }
        }
    });
</script>

{% else %}
<h2>Please <a href="/login">login</a> to continue...</h2>
{% endif %}
{% endblock %}
