(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3031],{47590:function(e,t){var o,r,n,i,a;o=t,n=void 0===Number.MAX_SAFE_INTEGER?0x1fffffffffffff:Number.MAX_SAFE_INTEGER,i=new WeakMap,a=(r=function(e,t){return i.set(e,t),t},function(e){var t=i.get(e),o=void 0===t?e.size:t<0x40000000?t+1:0;if(!e.has(o))return r(e,o);if(e.size<0x20000000){for(;e.has(o);)o=Math.floor(0x40000000*Math.random());return r(e,o)}if(e.size>n)throw Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;e.has(o);)o=Math.floor(Math.random()*n);return r(e,o)}),o.addUniqueNumber=function(e){var t=a(e);return e.add(t),t},o.generateUniqueNumber=a},93031:(e,t,o)=>{"use strict";o.d(t,{A:()=>P});var r=o(4483),n=o(22588),i=o(79474),a=o(47462),u=o(63692),s=o(20977),l=o(40994),c=o(89851),d=o(47590);let m=e=>void 0!==e.method&&"call"===e.method,f=e=>null===e.error&&"number"==typeof e.id,g=((e,t)=>{let o=null;return()=>{if(null!==o)return o;let r=new Blob([t],{type:"application/javascript; charset=utf-8"}),n=URL.createObjectURL(r);return o=e(n),setTimeout(()=>URL.revokeObjectURL(n)),o}})(e=>{let t=new Map([[0,()=>{}]]),o=new Map([[0,()=>{}]]),r=new Map,n=new Worker(e);return n.addEventListener("message",({data:e})=>{if(m(e)){let{params:{timerId:n,timerType:i}}=e;if("interval"===i){let e=t.get(n);if("number"==typeof e){let t=r.get(e);if(void 0===t||t.timerId!==n||t.timerType!==i)throw Error("The timer is in an undefined state.")}else if(void 0!==e)e();else throw Error("The timer is in an undefined state.")}else if("timeout"===i){let e=o.get(n);if("number"==typeof e){let t=r.get(e);if(void 0===t||t.timerId!==n||t.timerType!==i)throw Error("The timer is in an undefined state.")}else if(void 0!==e)e(),o.delete(n);else throw Error("The timer is in an undefined state.")}}else if(f(e)){let{id:n}=e,i=r.get(n);if(void 0===i)throw Error("The timer is in an undefined state.");let{timerId:a,timerType:u}=i;r.delete(n),"interval"===u?t.delete(a):o.delete(a)}else{let{error:{message:t}}=e;throw Error(t)}}),{clearInterval:e=>{let o=(0,d.generateUniqueNumber)(r);r.set(o,{timerId:e,timerType:"interval"}),t.set(e,o),n.postMessage({id:o,method:"clear",params:{timerId:e,timerType:"interval"}})},clearTimeout:e=>{let t=(0,d.generateUniqueNumber)(r);r.set(t,{timerId:e,timerType:"timeout"}),o.set(e,t),n.postMessage({id:t,method:"clear",params:{timerId:e,timerType:"timeout"}})},setInterval:(e,o=0)=>{let r=(0,d.generateUniqueNumber)(t);return t.set(r,()=>{e(),"function"==typeof t.get(r)&&n.postMessage({id:null,method:"set",params:{delay:o,now:performance.now(),timerId:r,timerType:"interval"}})}),n.postMessage({id:null,method:"set",params:{delay:o,now:performance.now(),timerId:r,timerType:"interval"}}),r},setTimeout:(e,t=0)=>{let r=(0,d.generateUniqueNumber)(o);return o.set(r,e),n.postMessage({id:null,method:"set",params:{delay:t,now:performance.now(),timerId:r,timerType:"timeout"}}),r}}},'(()=>{"use strict";const e=new Map,t=new Map,r=(e,t)=>{let r,o;const i=performance.now();r=i,o=e-Math.max(0,i-t);return{expected:r+o,remainingDelay:o}},o=(e,t,r,i)=>{const s=performance.now();s>r?postMessage({id:null,method:"call",params:{timerId:t,timerType:i}}):e.set(t,setTimeout(o,r-s,e,t,r,i))};addEventListener("message",(i=>{let{data:s}=i;try{if("clear"===s.method){const{id:r,params:{timerId:o,timerType:i}}=s;if("interval"===i)(t=>{const r=e.get(t);if(void 0===r)throw new Error(\'There is no interval scheduled with the given id "\'.concat(t,\'".\'));clearTimeout(r),e.delete(t)})(o),postMessage({error:null,id:r});else{if("timeout"!==i)throw new Error(\'The given type "\'.concat(i,\'" is not supported\'));(e=>{const r=t.get(e);if(void 0===r)throw new Error(\'There is no timeout scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(r),t.delete(e)})(o),postMessage({error:null,id:r})}}else{if("set"!==s.method)throw new Error(\'The given method "\'.concat(s.method,\'" is not supported\'));{const{params:{delay:i,now:n,timerId:a,timerType:d}}=s;if("interval"===d)((t,i,s)=>{const{expected:n,remainingDelay:a}=r(t,s);e.set(i,setTimeout(o,a,e,i,n,"interval"))})(i,a,n);else{if("timeout"!==d)throw new Error(\'The given type "\'.concat(d,\'" is not supported\'));((e,i,s)=>{const{expected:n,remainingDelay:a}=r(e,s);t.set(i,setTimeout(o,a,t,i,n,"timeout"))})(i,a,n)}}}}catch(e){postMessage({error:{message:e.message},id:s.id,result:null})}}))})();'),p=e=>g().clearTimeout(e),h=(...e)=>g().setTimeout(...e);var v=function(e){var t=e.seconds,o=void 0===t?0:t,r=(0,i.useState)(o),n=r[0],a=r[1],u=(0,i.useState)(!1),s=u[0],l=u[1];return(0,i.useEffect)(function(){if(n&&s){var e=h(function(){a(n-1)},1e3);return function(){return p(e)}}},[n,s]),[n,{resetCountdown:function(e){a(e||o)},enableTimer:function(e){l(e)}}]},w=function(e){return e<10?"0".concat(e):e},b="WISE_PAGE_VISIBLE",E=function(){localStorage.setItem(b,"1")},y=function(){localStorage.setItem(b,"0")},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;window.location.assign(e?"/login/logout?autoLogout=true&redirectUrl=".concat(e):"/login/logout?autoLogout=true")};let T=(0,o(6204).defineMessages)({logoutWarningHeading:{id:"business-web-components.auto-logout.modal.heading",defaultMessage:"You’re about to be logged out"},logoutWarningSubtitle:{id:"business-web-components.auto-logout.modal.subtitle",defaultMessage:"It looks like you’re not active right now. To keep your account secure, we’ll automatically log you out when the timer runs out."},continueButton:{id:"business-web-components.auto-logout.modal.continue-button",defaultMessage:"Stay logged in"},logoutButton:{id:"business-web-components.auto-logout.modal.logout-button",defaultMessage:"Log out now"}});var A=function(e){var t=e.showModal,o=e.redirectUrl,r=e.handleLogout,d=e.modalCloseHandler,m=e.timeout,f=(0,c.A)(),g=v({seconds:void 0===m?60:m}),p=(0,n.A)(g,2),h=p[0],E=p[1],y=E.resetCountdown,A=E.enableTimer;if((0,i.useEffect)(function(){A(t),y()},[t]),h<=0&&t){if(document.hidden&&!("undefined"!=typeof SharedWorker)&&"1"===localStorage.getItem(b))return y(5),i.createElement(i.Fragment,null);r?r():M(o)}var L=w(Math.floor(h/60)),S=w(h%60);return i.createElement(a.A,{body:i.createElement("div",{className:"center-contents text-xs-center"},i.createElement(l.a,{alt:"",name:l.A.SAND_TIMER,size:l.S.SMALL}),i.createElement("h2",{className:"m-t-4 m-b-2"},f.formatMessage(T.logoutWarningHeading)),i.createElement("p",null,f.formatMessage(T.logoutWarningSubtitle)),i.createElement("h2",{className:"m-b-2",style:{fontVariantNumeric:"tabular-nums"}},"".concat(L,":").concat(S)),i.createElement(u.A,{block:!0,priority:s.b.PRIMARY,type:s.m.ACCENT,onClick:d},f.formatMessage(T.continueButton)),i.createElement(u.A,{block:!0,priority:s.b.TERTIARY,onClick:function(){r?r():M(o)}},f.formatMessage(T.logoutButton))),onClose:d,open:t})},L=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return({default:t?3:240,maximum:t?6:540})[e]},S=["mousemove","keydown","wheel","mousedown","touchstart","touchmove","MSPointerDown","MSPointerMove"];function I(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),o.push.apply(o,r)}return o}function k(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?I(Object(o),!0).forEach(function(t){(0,r.A)(e,t,o[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):I(Object(o)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))})}return e}var O=Math.random().toString(36).substring(2),C=function(){try{var e=new SharedWorker("/public-resources/assets/service-workers/activity-broadcaster.js");return e.port.start(),e}catch(e){return null}}(),x={showAutoLogoutModal:function(){},setAutoLogoutDefaultTimeout:function(){},setAutoLogoutMaximumTimeout:function(){}},N=(0,i.createContext)(x),j=function(e){var t=e.children,o=e.trackingContext,r=e.trackEvent,a=e.dangerouslySetMaximumTimeout,u=e.redirectUrl,s=e.handleLogout,l=e.debugMode,c=void 0!==a&&a?"maximum":"default",d=L(c,l),m=(0,i.useState)(!1),f=m[0],g=m[1],p=(0,i.useState)(d),h=p[0],w=p[1],b=v({seconds:h}),M=(0,n.A)(b,2),T=M[0],I=M[1],x=I.resetCountdown,j=I.enableTimer,P={Context:void 0===o?"auto-logout":o,timeout:c},U=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:P;return r?r("Auto Logout - ".concat(e),t):null},D=function(){x(),g(!1),U("Modal closed")};(0,i.useEffect)(function(){E(),U("Enabled"),j(!0);try{C&&(C.port.onmessage=function(e){var t=e.data;"ACTIVE"===t.payload&&t.tabId!==O&&D()})}catch(e){console.error("Shared Worker failed to initialize",e)}},[]),(0,i.useEffect)(function(){var e=function(){var e;x(),null==C||null===(e=C.port)||void 0===e||e.postMessage({payload:"ACTIVE",tabId:O})},t=function(){document.hidden?y():E()};return Object.values(S).forEach(function(t){window.addEventListener(t,e)}),window.addEventListener("visibilitychange",t),function(){Object.values(S).forEach(function(t){window.removeEventListener(t,e)}),window.removeEventListener("visibilitychange",t)}},[f]);var R=function(){g(!0),U("Modal displayed")};(0,i.useEffect)(function(){T<=0&&!f&&(R(),U("Modal displayed"))},[T]);var _=(0,i.useMemo)(function(){return{showAutoLogoutModal:R,setAutoLogoutDefaultTimeout:function(){U("Timeout Changed",k(k({},P),{},{timeout:"default"})),w(240)},setAutoLogoutMaximumTimeout:function(){U("Timeout Changed",k(k({},P),{},{timeout:"maximum"})),w(540)}}},[]);return i.createElement(N.Provider,{value:_},t,i.createElement(A,{handleLogout:s,redirectUrl:u,showModal:f,modalCloseHandler:D}))};let P=function(e){var t=e.isFeatureEnabled,o=e.children;return t?i.createElement(j,k({},e)):i.createElement(N.Provider,{value:x},o)}}}]);
//# sourceMappingURL=3031-46b37378bfa4f644.js.map