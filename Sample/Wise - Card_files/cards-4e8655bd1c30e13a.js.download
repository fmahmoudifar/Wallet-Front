(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4885],{30392:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/cards",function(){return a(15673)}])},30244:(e,t,a)=>{"use strict";async function r(e){var t;let{httpClient:a,profileId:r}=e,{data:s}=await a.get({url:"/v3/borderless-accounts/cards/profiles/".concat(r,"/spendings"),upstream:"twcard-management"});return null!==(t=s.spendings)&&void 0!==t?t:[]}async function s(e){let{httpClient:t,profileId:a,command:r}=e,{data:s}=await t.patch({url:"/v3/borderless-accounts/cards/profiles/".concat(a,"/spendings"),upstream:"twcard-management",data:r});return s}a.d(t,{I:()=>s,v:()=>r})},61272:(e,t,a)=>{"use strict";a.d(t,{G:()=>l,n:()=>o});let r="twcard-fraud-bff",s={PURCHASES_MONTHLY:"PurchasesMonthly"},n={PROFILE:"PROFILE"},i={available:!1,pendingRequests:[],minimumAmount:null},l=async e=>{let{httpClient:t,profileId:a}=e;return t.get({url:"/v1/profiles/".concat(a,"/limit-increase-request/status"),upstream:r}).then(e=>e.data).catch(()=>i)},o=async e=>{let{httpClient:t,profileId:a,limitIncreaseRequest:i}=e,l={scope:n.PROFILE,aggregate:s.PURCHASES_MONTHLY,amount:i.amount,reason:i.reason,validUntil:i.validUntil};return t.post({url:"/v1/profiles/".concat(a,"/limit-increase-request"),upstream:r,data:l})}},51557:(e,t,a)=>{"use strict";a.d(t,{U:()=>s,Z:()=>n});var r=a(38333);let s=async e=>{let{httpClient:t,profileId:a,privileges:s}=e;if(!(0,r.Sl)(s,r.fd.canManageCardAccountSpendingLimits))return[];let{data:n}=await t.get({url:"/v1/profiles/".concat(a,"/spend-limits"),upstream:"twcard-fraud-bff"}).catch(e=>{if(303===e.status)return{data:[]};throw e});return n},n=async e=>{let{profileId:t,dailyLimitInput:a,monthlyLimitInput:r,previousLimit:s,scaRequest:n}=e,i=await n("/gateway/v1/profiles/".concat(t,"/spend-limits"),{method:"POST",headers:{"X-Access-Token":"Tr4n5f3rw153"},credentials:"include",body:JSON.stringify([{type:s.type,aggregateWindow:{daily:{value:{value:a,currency:s.aggregateWindow.daily.value.currency}},monthly:{value:{value:r,currency:s.aggregateWindow.monthly.value.currency}}}}])});return await i.json()}},12482:(e,t,a)=>{"use strict";a.d(t,{s:()=>g});var r=a(65723),s=a(84212),n=a(69967),i=a(93753),l=a(87633),o=a(21159),d=a(40042),c=a(39754),u=a(22155);let p=async e=>{let{httpClient:t,profileId:a,cardOrderId:r}=e,{data:s}=await t.get({url:"/v4/profiles/".concat(a,"/card-orders/").concat(r,"/cancellation-form"),upstream:"twcard-order"});return s};var m=a(59322),h=a(92586);let f=()=>(0,u.useMemo)(()=>(0,h.mo)("/gateway",{"X-Access-Token":"Tr4n5f3rw153"}),[]);function g(e){let{isOpen:t,onClose:a,onOrderCancel:h,httpClient:g,cardOrderId:b,profileId:y,onTrack:x}=e,C=f(),{data:A,isLoading:E,error:j,isError:v}=(0,s.I)({queryKey:["card-cancel-form",b,y],queryFn:async()=>p({httpClient:g,profileId:y,cardOrderId:b}),enabled:t}),[N,S]=(0,u.useState)(null),[I,R]=(0,u.useState)();return(0,r.jsx)(n.A,{open:t,body:(0,r.jsxs)(i.A,{children:[(v||N)&&(0,r.jsx)(m.c,{error:null!=j?j:N}),I&&(0,r.jsx)(l.A,{type:"error",message:I}),E&&(0,r.jsx)(o.C,{}),A&&(0,r.jsx)(c.CZ,{initialStep:A,loaderConfig:{initial:!1},customFetch:C,flowId:"CARD_ORDER_CANCELLATION",onCompletion:e=>{e&&"error"in e&&R(e.error),h()},onEvent:(e,t)=>{null==x||x((0,d.s)({base:e},{properties:t}))},onError:e=>{S(e)}})]}),onClose:a})}},8383:(e,t,a)=>{"use strict";a.d(t,{Me:()=>i,P5:()=>s,dr:()=>n,no:()=>r});let r={checkIncreaseLimitsStatus:()=>["checkIncreaseLimitsStatus"],profileSpendingLimits:()=>["profileSpendingLimits"],userSpendingLimits:()=>["userSpendingLimits"],accountSpendings:()=>["accountSpendings"]},s="/cards/limits",n="/cards/user-limits",i="/cards/limits-selector"},42456:(e,t,a)=>{"use strict";a.d(t,{a:()=>i});var r=a(84212),s=a(61272),n=a(8383);let i=e=>{let{httpClient:t,profileId:a}=e,{data:i={available:!1,pendingRequests:[],minimumAmount:null}}=(0,r.I)({queryKey:n.no.checkIncreaseLimitsStatus(),queryFn:async()=>(0,s.G)({httpClient:t,profileId:a})});return i}},47354:(e,t,a)=>{"use strict";a.d(t,{a:()=>c});var r=a(84212),s=a(21523),n=a(30244),i=a(51557);async function l(e){let{httpClient:t,profileId:a,userId:r}=e,{data:s}=await t.get({url:"/v1/profiles/".concat(a,"/users/").concat(r,"/spend-limits"),upstream:"twcard-fraud-bff"});return s}var o=a(8383),d=a(42456);let c=e=>{let{httpClient:t,profileId:a,userId:c}=e,{privileges:u}=(0,s.wn)(),{data:p=[]}=(0,r.I)({queryKey:o.no.profileSpendingLimits(),queryFn:async()=>(0,i.U)({httpClient:t,profileId:a,privileges:u})}),{data:m=[]}=(0,r.I)({queryKey:o.no.userSpendingLimits(),queryFn:async()=>l({httpClient:t,profileId:a,userId:c})}),{data:h=[]}=(0,r.I)({queryKey:o.no.accountSpendings(),queryFn:async()=>(0,n.v)({httpClient:t,profileId:a})});return{aggregatedProfileLimits:p,aggregatedUserLimits:m,legacyProfileSpendings:h,limitIncreaseRequestStatus:(0,d.a)({httpClient:t,profileId:a})}}},15673:(e,t,a)=>{"use strict";a.r(t),a.d(t,{__N_SSP:()=>tD,default:()=>tk});var r,s=a(65723),n=a(72061),i=a(56367),l=a(54652),o=a(72994),d=a(52419),c=a(82209),u=a(19294),p=a(55746),m=a(84212),h=a(31917),f=a(51370),g=a(8661),b=a(58085),y=a(27868),x=a(21523),C=a(37192),A=a(8970),E=a(22155),j=a(65629),v=a(85783),N=a(13375),S=a(31591),I=a(46660),R=a(78565);let O=[C.vj.ACTIVE,C.vj.FROZEN,C.vj.EXPIRED,C.vj.INACTIVE],_=e=>{let{cards:t,userId:a}=e;return t?t.filter(e=>O.includes(e.status.value)).filter(e=>(null==e?void 0:e.userId)===a):[]},T=[C.tP.CANCELLED,C.tP.COMPLETED,C.tP.RETURNED],D=e=>{let{cardOrders:t,cards:a,userId:r}=e;if(!t)return[];let s=_({cards:a,userId:r}).map(e=>e.token);return t.filter(e=>e.cardToken?!s.includes(e.cardToken):e).filter(e=>!T.includes(e.status))},k=e=>{let{profileActorsAndCards:t,userId:a}=e,r=t.toSorted((e,t)=>e.name.localeCompare(t.name)).filter(e=>e.userId!==a),s=r.some(e=>e.cards.some(e=>e.group)),n=r.reduce((e,t)=>e+t.cards.length,0);return{profileActorsAndCards:r,profileHasGroupCards:s,numberOfActiveCards:n}},L=(0,R.vt)()((e,t)=>({profileActorsAndCards:[],numberOfActiveCards:0,teamCards:[],profileHasGroupCards:!1,setActorsAndCards:(t,a)=>e(k({profileActorsAndCards:t,userId:a})),getTeamCards:e=>{let{profileActorsAndCards:a}=t();return a.flatMap(t=>t.cards.map(a=>{var r,s,n;return{actor:{userId:t.userId,name:t.name,avatar:null!==(s=t.avatar)&&void 0!==s?s:void 0,spendingBlocked:t.spendingPermissionOverrides.includes(i.aH.GENERAL_LIMIT)},card:{cardVectorAssetUrl:(0,I._l)({cardStatus:a.status,cardStyle:a.cardStyle}),maskedCardNumberText:(0,N.g)(a.lastFourDigits),cardLabelTitle:(0,S.g)({cardType:a.type,cardStyle:a.cardStyle,cardLabel:void 0,intl:e}),cardStatusText:(0,S.h)({cardStatus:a.status,expiringSoon:!1,expiryDate:a.expiryDate,intl:e}),group:null!==(n=null===(r=a.group)||void 0===r?void 0:r.name)&&void 0!==n?n:e.formatMessage({id:"cards-page.team-cards-list.main-group",defaultMessage:"Main Group"})}}}))}}));var M=a(50324),w=a(97191),P=a(91482);function B(){let{formatMessage:e}=(0,c.A)();return(0,s.jsx)(P.A,{as:"a",href:"/team/members/add",children:e({id:"cards-page.tabs.team-cards.get-cards-for-team-slide.action.title",defaultMessage:"Add team member"})})}var W=a(10541),F=a.n(W);function U(){let{formatMessage:e}=(0,c.A)(),{canManageActors:t}=(0,x.wn)();return(0,s.jsx)("div",{className:F().teamCardsEmptyState,children:t?(0,s.jsx)(M.C,{illustrationName:w.A.PUZZLE_PIECES,title:e({id:"cards-page.tabs.team-cards.empty-state.title",defaultMessage:"Get cards for your team"}),subtext:e({id:"cards-page.tabs.team-cards.empty-state.message",defaultMessage:"Add team members and give them permission to order a card. You can also set spending limits for peace of mind."}),actions:(0,s.jsx)(B,{})}):(0,s.jsx)(M.C,{illustrationName:w.A.PUZZLE_PIECES,title:e({id:"cards-page.tabs.team-cards.empty-state.title.no-manage-privilege",defaultMessage:"All your team's cards in one place"}),subtext:e({id:"cards-page.tabs.team-cards.empty-state.message.no-manage-privilege",defaultMessage:"When your team members order cards, you'll be able to see them here."})})})}var G=a(72993),q=a(83578),V=a(52806),$=a(79068),Y=a(70851),K=a(84319);let H=({text:e,className:t,status:a,typography:r="default"})=>{let n=a??"default-bold"===r?q.o.BODY_DEFAULT_BOLD:q.o.BODY_DEFAULT;return(0,s.jsxs)(K.A,{type:n,className:(0,Y.$)(t,{"np-table-content--success":"success"===a,"np-table-content--error":"error"===a}),children:[e,"success"===a&&(0,s.jsx)($.CheckCircle,{className:"tw-icon--status","data-testid":"check-icon"}),"error"===a&&(0,s.jsx)($.AlertCircle,{className:"tw-icon--status","data-testid":"alert-icon"})]})};var X=a(18244),z=a(39680);let Q=({amount:e,currency:t,alwaysShowDecimals:a=!1})=>{let{locale:r}=(0,c.A)();return(0,s.jsx)(s.Fragment,{children:(0,z.up)(e,t,r,{alwaysShowDecimals:a})})};var Z=a(8593);let J=({cell:e,alignment:t="left",className:a,colSpan:r,children:n})=>{let i=e=>e?(0,s.jsx)(Q,{amount:e.amount,currency:e.currency,alwaysShowDecimals:!0}):"";return(0,s.jsxs)("td",{className:(0,Y.$)("np-table-cell",e?.type?`np-table-cell--${e?.type}`:"",`np-table-cell--${t}`,a),colSpan:r,children:[e?.type==="text"&&e?.text&&(0,s.jsx)(H,{text:e?.text,status:e?.status}),e?.type&&["leading","currency","status","media"].includes(e?.type)&&(0,s.jsxs)("div",{className:(0,Y.$)("np-table-content",{"np-table-content--reversed":"right"===t}),"data-testid":"np-table-content",children:[(()=>{let t=null;if(e?.type==="leading"&&(e?.avatar?.src||e?.avatar?.profileName)&&(t=(0,s.jsx)(Z.A,{profileName:e?.avatar?.profileName,size:40,imgSrc:e?.avatar?.src})),e?.type==="currency"&&e?.primaryCurrency?.currency&&(t=(0,s.jsx)(w.F,{code:e?.primaryCurrency?.currency?.toLowerCase(),intrinsicSize:24})),e?.type==="status"&&(t=(0,s.jsx)(X.A,{size:24,sentiment:e?.sentiment??"neutral"})),e?.type==="media"&&e.media&&(t=(0,s.jsx)("img",{...e.media})),t)return(0,s.jsx)("div",{"aria-hidden":"true",className:"np-table-content-media","data-testid":"np-table-content-media",children:t})})(),(0,s.jsxs)("div",{className:"np-table-content-body",children:[(e?.primaryCurrency??e?.primaryText)&&(0,s.jsx)(H,{text:e?.type==="currency"?i(e?.primaryCurrency):e?.primaryText??"",status:e?.type!=="status"?e?.status:void 0,typography:"default-bold"}),(e?.secondaryCurrency??e?.secondaryText)&&(0,s.jsx)(K.A,{children:e?.type==="currency"?i(e?.secondaryCurrency):e?.secondaryText})]})]}),n]})};var ee=(0,a(13210).YK)({loading:{id:"neptune.Table.loading"},loaded:{id:"neptune.Table.loaded"},emptyData:{id:"neptune.Table.emptyData"},refreshPage:{id:"neptune.Table.refreshPage"},actionHeader:{id:"neptune.Table.actionHeader"}});let et=({header:e,className:t,alignment:a="left",status:r,width:n,isActionHeader:i=!1})=>{let{formatMessage:l}=(0,c.A)();return(0,s.jsx)("th",{className:(0,Y.$)("np-table-header",t,`np-table-header--${a}`,{"np-table-header--error":"error"===r,"np-table-header--action":i}),style:{minWidth:n,width:n},children:i?(0,s.jsx)(H,{text:l(ee.actionHeader),className:`np-table-header-content${i?" sr-only":""}`}):e?(0,s.jsx)(H,{text:e,className:`np-table-header-content${i?" sr-only":""}`,status:r,typography:"default-bold"}):(0,s.jsx)("div",{className:"np-table-header-content np-text-body-default-bold","data-testid":"np-table-empty-header",children:"\xa0"})})};var ea=a(67413),er=a(86448);let es=({rowData:e,hasSeparator:t=!1,children:a,onRowClick:r})=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("tr",{className:(0,Y.$)("np-table-row",{"np-table-row--clickable":!!r}),"data-testid":"np-table-row",role:r?"button":void 0,tabIndex:0,onClick:r&&e?()=>r(e):void 0,onKeyDown:({key:t})=>{r&&e&&"Enter"===t&&r(e)},children:[e?.cells?e?.cells?.map((e,t)=>{let a=e.cell?.text?e.cell?.text.concat(t.toString()):t;return s.jsx(J,{...e},a)}):a,r&&(0,s.jsx)(J,{className:"np-table-cell--action",children:(0,s.jsx)("div",{"aria-hidden":"true",children:(0,s.jsx)(ea.A,{orientation:er.y.RIGHT})})})]}),t&&(0,s.jsx)("tr",{"aria-hidden":"true",className:"np-table-row np-table-row--separator","data-testid":"np-table-row--separator",children:(0,s.jsx)("td",{className:"np-table-cell np-table-cell--cosmetic",colSpan:r?Number(e?.cells?.length)+1:e?.cells?.length,"data-testid":"np-table-cell--cosmetic",children:(0,s.jsx)("div",{className:"np-table-cell-separator","data-testid":"np-table-cell-separator"})})})]});var en=a(87633),ei=a(80920),el=a(71218);let eo=({"aria-labelledby":e,data:t,loading:a,className:r,fullWidth:n=!0,error:i})=>{let{formatMessage:l}=(0,c.A)(),{theme:o}=(0,el.D)(),d=a??(t?.headers&&!t?.headers.length),u=()=>{let e=t?.headers?.length??0;return t?.onRowClick?e+1:e};return i?(0,s.jsx)(en.A,{className:"np-table-error",message:i.message,type:ei.g.NEGATIVE,action:{href:i?.action?.href??"/",text:i?.action?.text??l(ee.refreshPage)},"data-testid":"np-table-error"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{"aria-live":"polite",className:"sr-only",children:l(ee[a?"loading":"loaded"])}),(0,s.jsx)("div",{role:a?"presentation":"region","aria-labelledby":e,className:(0,Y.$)("np-table-outer-container",r,{"np-theme-personal":"bright-green"===o,"np-table-outer-container--center":!n,"np-table-outer-container--full-width":n}),tabIndex:0,"data-testid":"np-table-outer-container",children:(0,s.jsx)("div",{className:(0,Y.$)("np-table-container",{"np-table-container--loading":a}),"data-testid":"np-table-container",children:(0,s.jsx)("div",{className:"np-table-inner-container",children:(0,s.jsxs)("table",{className:"np-table",children:[(0,s.jsx)("thead",{"aria-hidden":d,children:(0,s.jsxs)("tr",{children:[d?(0,s.jsx)(et,{}):t?.headers?.map((e,t)=>s.jsx(et,{...e},e.header?.concat(t.toString()))),t?.onRowClick&&(0,s.jsx)(et,{isActionHeader:!0})]})}),(0,s.jsxs)("tbody",{children:[(0,s.jsx)("tr",{"aria-hidden":"true",className:"np-table-row np-table-row--cosmetic",children:(0,s.jsx)("td",{className:"np-table-cell",colSpan:u()})},"first-np-table-row--cosmetic"),a?(0,s.jsx)(es,{children:(0,s.jsx)(J,{children:(0,s.jsx)(h.A,{"data-testid":"np-table-loader"})})}):t?.rows?.length?t?.rows?.map((e,a)=>s.jsx(es,{rowData:e,hasSeparator:!!t?.rows?.length&&t.rows.length-1!==a,onRowClick:t?.onRowClick},"table-row-".concat(a.toString()))):(0,s.jsx)(es,{children:(0,s.jsx)(J,{colSpan:t?.headers?.length,children:(0,s.jsxs)("div",{className:"np-table-empty-data","data-testid":"np-table-empty-data",children:[(0,s.jsx)(X.A,{sentiment:ei.g.WARNING,size:f.o.MEDIUM}),(0,s.jsx)(K.A,{type:"body-default-bold",children:l(ee.emptyData)})]})})}),(0,s.jsx)("tr",{"aria-hidden":"true",className:"np-table-row np-table-row--cosmetic",children:(0,s.jsx)("td",{className:"np-table-cell",colSpan:u()})},"last-np-table-row--cosmetic")]})]})})})})]})};var ed=a(32373),ec=a(30939),eu=a.n(ec);let ep=()=>{let{formatMessage:e}=(0,c.A)(),t=e({id:"cards-page.tabs.team-cards.actor.spending-blocked.tooltip.label",defaultMessage:"This team member's cards are currently blocked. They can be unblocked by anyone with permission to manage team members."});return(0,s.jsxs)("div",{className:"d-inline-flex align-items-center",children:[(0,s.jsx)("div",{className:eu().statusIcon,children:(0,s.jsx)(X.A,{sentiment:ei.g.WARNING,size:f.o.SMALL})}),(0,s.jsx)("div",{className:eu().description,children:e({id:"cards-page.tabs.team-cards.actor.spending-blocked",defaultMessage:"Spending blocked"})}),(0,s.jsx)("div",{className:eu().spendingBlockedTooltipWrapper,children:(0,s.jsx)(ed.A,{label:t,position:er.y.RIGHT,children:(0,s.jsx)("div",{children:(0,s.jsx)($.QuestionMarkCircle,{})})})})]})};function em(){let e=(0,c.A)(),t=(0,A.useRouter)(),a=(0,E.useRef)(null),r=L(e=>e.numberOfActiveCards),n=L(e=>e.profileHasGroupCards),i=L(e=>e.getTeamCards)(e),[l,o]=(0,E.useState)(i),d=[{header:e.formatMessage({id:"cards-page.tabs.team-cards.table.header.cardholder",defaultMessage:"Cardholder"})},{header:e.formatMessage({id:"cards-page.tabs.team-cards.table.header.card",defaultMessage:"Card"})},{header:e.formatMessage({id:"cards-page.tabs.team-cards.table.header.status",defaultMessage:"Status"}),width:"20%"},...n?[{header:e.formatMessage({id:"cards-page.tabs.team-cards.table.header.group",defaultMessage:"Group"}),width:"20%"}]:[]],u=l.map(e=>({id:e.actor.userId,cells:[{cell:{type:"leading",primaryText:e.actor.name,secondaryText:e.actor.spendingBlocked?(0,s.jsx)(ep,{}):void 0,avatar:{src:e.actor.avatar,profileName:e.actor.name}}},{cell:{type:"media",primaryText:e.card.maskedCardNumberText,secondaryText:e.card.cardLabelTitle,media:{src:e.card.cardVectorAssetUrl,width:48}}},{cell:{type:"leading",primaryText:e.card.cardStatusText}},...n?[{cell:{type:"leading",primaryText:e.card.group}}]:[]]}));return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"m-y-4 d-flex justify-content-between",children:[(0,s.jsx)(G.A,{type:q.o.TITLE_SUBSECTION,children:e.formatMessage({id:"cards-page.tabs.team-cards.active-cards",defaultMessage:"{numberOfActiveCards, plural, one {1 team card} other {{numberOfActiveCards} team cards}}"},{numberOfActiveCards:r})}),(0,s.jsx)("div",{style:{minWidth:295},children:(0,s.jsx)(V.D,{placeholder:n?e.formatMessage({id:"cards-page.tabs.team-cards.search.placeholder",defaultMessage:"Team member, status, group"}):e.formatMessage({id:"cards-page.tabs.team-cards.search.placeholder.no-group",defaultMessage:"Team member, status"}),size:f.o.SMALL,onChange:e=>{let t=e.target.value.toLowerCase();o(i.filter(e=>e.actor.name.toLowerCase().includes(t)||e.card.cardStatusText.toLowerCase().includes(t)||n&&e.card.group.toLowerCase().includes(t)))}})})]}),(0,s.jsx)("div",{ref:a,onTouchStart:e=>{a.current&&(a.current={...a.current,isScrolling:!1,startX:e.touches[0].pageX})},onTouchMove:e=>{a.current&&Math.abs(e.touches[0].pageX-a.current.startX)>5&&(a.current={...a.current,isScrolling:!0},e.stopPropagation())},children:(0,s.jsx)(eo,{data:{headers:d,rows:u,onRowClick:e=>{t.push("/team/members/".concat(e.id,"?cardTabId=1"))}}})})]})}function eh(){return 0===L(e=>e.numberOfActiveCards)?(0,s.jsx)(U,{}):(0,s.jsx)(em,{})}var ef=a(34591),eg=a(21159),eb=a(29136),ey=a(74891),ex=a(28829),eC=a(92112),eA=a(19439),eE=a(7812),ej=a(69967),ev=a(93753),eN=a(51690),eS=a(75693),eI=Object.getOwnPropertyNames;((e,t)=>function(){return e&&(t=(0,e[eI(e)[0]])(e=0)),t})({"../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs"(){r=function(){return(r=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var s in t=arguments[a])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)}}})();var eR="/gateway",eO=e=>{let{locale:t}=e;return new eS.QX({axiosConfig:{baseURL:eR,headers:{"X-Access-Token":"Tr4n5f3rw153","Accept-Language":t}}})},e_=async e=>{let{profileId:t,page:a,feature:r,scale:s,feedback:n,httpClient:i}=e,{data:l}=await i.post({url:"/v1/feedback/feature",data:{profileId:t,pageName:a,featureName:r,scale:s,platform:"WEB",...n},upstream:"nps-service",config:{baseURL:eR}});return l},eT=async e=>{let{comment:t,...a}=e;return e_({...a,scale:3,feedback:{comment:t,score:3}})},eD=async e=>{let{id:t,feedback:a,httpClient:r}=e,{data:s}=await r.patch({url:"/v1/feedback/".concat(t),data:{feedback:a},upstream:"nps-service",config:{baseURL:eR}});return s},ek=e=>"https://wise.com/public-resources/assets".concat(e),eL={emojiSelector:"EmojiScale_emojiSelector",emojiOption:"EmojiScale_emojiOption"},eM=e=>{let{scoreLabel:t,rating:a,scale:r,onChange:n}=e,i=(0,c.A)(),l=[{id:1,image:"angry_face.png",accessibilityName:i.formatMessage({id:"feedback-components.feedback-modal-body.options.very-bad",defaultMessage:"Very bad"})},{id:2,image:"sad_face.png",accessibilityName:i.formatMessage({id:"feedback-components.feedback-modal-body.options.bad",defaultMessage:"Bad"})},{id:3,image:"neutral_face.png",accessibilityName:i.formatMessage({id:"feedback-components.feedback-modal-body.options.neutral",defaultMessage:"Neutral"})},{id:4,image:"smiling_face.png",accessibilityName:i.formatMessage({id:"feedback-components.feedback-modal-body.options.good",defaultMessage:"Good"})},{id:5,image:"love_face.png",accessibilityName:i.formatMessage({id:"feedback-components.feedback-modal-body.options.very-good",defaultMessage:"Very good"})}],o=5===r?l:l.slice(1,4).map((e,t)=>({...e,id:t+1})),d=(0,E.useId)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"text-primary np-text-body-default-bold",role:"heading","aria-level":3,children:t}),(0,s.jsx)("div",{className:eL.emojiSelector,children:o.map(e=>(0,s.jsxs)("div",{className:eL.emojiOption,children:[(0,s.jsx)("input",{type:"radio",name:"emoji-selector-".concat(d),id:"emoji-selector-".concat(d,"-").concat(e.id),value:e.id,checked:a===e.id,onChange:e=>n(Number(e.target.value))}),(0,s.jsxs)("label",{htmlFor:"emoji-selector-".concat(d,"-").concat(e.id),children:[(0,s.jsx)("img",{alt:"",src:ek("/balances/feedback-emojis/".concat(ew(),"/").concat(e.image))}),(0,s.jsx)("span",{className:"sr-only",children:e.accessibilityName})]})]},e.id))})]})},ew=()=>"undefined"!=typeof navigator&&navigator.platform&&/Mac|iPad|iPhone|iPod/u.test(navigator.platform)?"apple":"google",eP={feedbackInput:"FeedbackModalBody_feedbackInput"},eB={likertScaleContainer:"LikertScale_likertScaleContainer",likertScaleTextContainer:"LikertScale_likertScaleTextContainer",likertScaleDisagree:"LikertScale_likertScaleDisagree",likertScaleAgree:"LikertScale_likertScaleAgree"},eW=e=>{let{options:t,scoreLabel:a,score:r,onChange:n}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h3",{className:"m-b-2",children:a}),(0,s.jsx)("div",{className:"".concat(eB.likertScaleContainer," m-b-1"),children:t.map(e=>{let{value:t,description:a}=e;return(0,s.jsxs)(E.Fragment,{children:[(0,s.jsx)("input",{type:"radio",name:"likert",id:"likert-".concat(t),value:t,checked:r===t,"aria-label":a,onChange:e=>n(Number(e.target.value))},t),(0,s.jsx)("label",{htmlFor:"likert-".concat(t),children:t})]},t)})}),(0,s.jsxs)("div",{className:"".concat(eB.likertScaleTextContainer," m-b-3"),"aria-hidden":!0,children:[(0,s.jsx)("span",{className:eB.likertScaleDisagree,children:t[0].description}),(0,s.jsx)("span",{className:eB.likertScaleAgree,children:t[t.length-1].description})]})]})},eF=e=>{let{scoreLabel:t,scale:a,commentLabel:r,hasConsentOption:n,onChange:i}=e,l=(0,c.A)(),[o,d]=(0,E.useState)(0),[u,p]=(0,E.useState)(""),[m,h]=(0,E.useState)(!1);return(0,E.useEffect)(()=>{i({rating:o,message:u,hasConsent:m})},[i,o,u,m]),(0,s.jsxs)("div",{children:[(null==a?void 0:a.type)==="EMOJI"?(0,s.jsx)(eM,{rating:o,scale:a.numberOfOptions,scoreLabel:t,onChange:e=>d(e)}):null,(null==a?void 0:a.type)==="LIKERT"?(0,s.jsx)(eW,{options:a.options,score:o,scoreLabel:t,onChange:e=>d(e)}):null,(0,s.jsx)(ex.D,{className:"control-label",id:"feedback-field",label:r||l.formatMessage({id:"feedback-components.feedback-modal-body.input-field.label",defaultMessage:"Let us know what you think — just don’t include any personal details"}),required:!1,...300<=u.length&&{message:l.formatMessage({id:"feedback-components.feedback-modal-body.input-field.max-length-warning",defaultMessage:"You have reached the maximum number of characters in your feedback."}),sentiment:ei.g.WARNING},children:(0,s.jsx)(eC.f,{className:"".concat(eP.feedbackInput," form-control"),id:"feedback-field",value:u,onChange:e=>e.target.value.length<=300&&p(e.target.value)})}),n&&(0,s.jsx)(eA.A,{content:l.formatMessage({id:"feedback-components.feedback-modal-body.consent-field.label",defaultMessage:"I'm happy for Wise to contact me to discuss my feedback"}),checked:m,title:void 0,"aria-label":l.formatMessage({id:"feedback-components.feedback-modal-body.consent-field.aria-label",defaultMessage:"Consent to be contacted"}),isContainerAligned:!0,onChange:()=>h(!m)})]})},eU=e=>Object.prototype.hasOwnProperty.call(e,"feature"),eG=e=>{let{title:t,commentLabel:a,scoreLabel:n,submitLabel:i,scale:l,open:o,httpClient:d,profileId:u,showConsentToggle:p=!0,onClose:m,...h}=e,[f,g]=(0,E.useState)({rating:0,message:"",hasConsent:!1}),[b,y]=(0,E.useState)(!1),x=(0,eE.A)(),{locale:C,formatMessage:A}=(0,c.A)(),j=A({defaultMessage:"Thanks! We appreciate your feedback.",id:"feedback-components.feedback-modal.success-alert"}),v=A({defaultMessage:"Thanks! We’ve received your feedback.",id:"feedback-components.feedback-modal.already-submitted"}),N=e=>{m(e),setTimeout(()=>{y(!0)},350),x({text:j})},[{loading:S,value:I,error:R},O]=function(e,t,a){void 0===t&&(t=[]),void 0===a&&(a={loading:!1});var s,n,i=(0,E.useRef)(0),l=(s=(0,E.useRef)(!1),n=(0,E.useCallback)(function(){return s.current},[]),(0,E.useEffect)(function(){return s.current=!0,function(){s.current=!1}},[]),n),o=(0,E.useState)(a),d=o[0],c=o[1],u=(0,E.useCallback)(function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];var s=++i.current;return d.loading||c(function(e){return r(r({},e),{loading:!0})}),e.apply(void 0,t).then(function(e){return l()&&s===i.current&&c({value:e,loading:!1}),e},function(e){return l()&&s===i.current&&c({error:e,loading:!1}),e})},t);return[d,u]}(async()=>{if(!eU(h)){if(0===f.rating){m("incomplete");return}return eD({id:h.sessionId,feedback:{score:f.rating,comment:f.message,additionalProperties:h.additionalProperties,hasExplicitConsentForReplyBack:f.hasConsent},httpClient:null!=d?d:eO({locale:C})}).finally(()=>N("submitted"))}if(null===l){if(0===f.message.length){m("incomplete");return}return eT({httpClient:null!=d?d:eO({locale:C}),profileId:u,page:h.page,feature:h.feature,comment:f.message,hasExplicitConsentForReplyBack:f.hasConsent}).finally(()=>N("submitted"))}if(0===f.rating){m("incomplete");return}return e_({httpClient:null!=d?d:eO({locale:C}),profileId:u,page:h.page,feature:h.feature,feedback:{score:f.rating,comment:f.message,hasExplicitConsentForReplyBack:f.hasConsent},scale:"EMOJI"===l.type?l.numberOfOptions:l.options.length}).finally(()=>N("submitted"))},[f]),_=!S&&(void 0!==R||void 0!==I),T=null!==l&&0===f.rating;return(0,s.jsx)(ej.A,{title:t,body:_&&b?(0,s.jsx)(en.A,{className:"m-t-2",type:"positive",message:v}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eF,{scoreLabel:n,scale:l,commentLabel:a,hasConsentOption:p,onChange:g}),(0,s.jsx)(P.A,{disabled:T||_,loading:S,className:"m-t-3",block:!0,priority:"primary",onClick:()=>{O()},children:i||(0,s.jsx)(eN.A,{defaultMessage:"Done",id:"feedback-components.feedback-modal.submit.label"})})]}),open:o,disableDimmerClickToClose:!0,onClose:()=>m("user-dismissed")})},eq=e=>(0,s.jsx)(ev.A,{children:(0,s.jsx)(eG,{...e})});let eV=(e,t)=>{let a=e.some(e=>e.status.value===C.vj.ACTIVE),r=t.some(e=>e.status===C.tP.COMPLETED);return a||r},e$=(0,R.vt)()((e,t)=>({allCards:[],allCardOrders:[],cardsInListUi:[],cardOrdersInListUi:[],userSpendingDisabled:null,orderCardButtonResponse:null,setOrderCardButtonResponse:t=>e({orderCardButtonResponse:t}),setAllCardsAndCardOrders:(t,a,r)=>{e(()=>({allCards:null!=t?t:[],allCardOrders:null!=a?a:[],cardsInListUi:_({cards:t,userId:r}),cardOrdersInListUi:D({cards:t,cardOrders:a,userId:r})}))},setUserSpendingDisabled:t=>{e(()=>({userSpendingDisabled:t}))},isCardListPopulated:()=>{let{cardsInListUi:e,cardOrdersInListUi:a}=t();return e.length>0||a.length>0},shouldShowCardsFeedback:()=>{let{cardsInListUi:e,cardOrdersInListUi:a}=t();return eV(e,a)}}));var eY=a(42744);function eK(e){let{onFeedbackClick:t}=e,{formatMessage:a}=(0,c.A)();return(0,s.jsx)("div",{children:(0,s.jsxs)(K.A,{children:[a({id:"cards-page.sections.card-feedback.label",defaultMessage:"Is there anything we could do better?"})," ",(0,s.jsx)(eY.A,{href:"#",onClick:e=>{e.preventDefault(),t()},children:a({id:"cards-page.sections.card-feedback.link",defaultMessage:"Give us feedback"})})]})})}function eH(){let{httpClient:e}=(0,j.r)(),{formatMessage:t}=(0,c.A)(),a=(0,p.v)(e=>e.selectedProfile),r=e$(e=>e.shouldShowCardsFeedback),[n,i]=(0,E.useState)(!1),l=(0,E.useMemo)(()=>({"Profile Id":a.id,"Profile Type":(0,ey.c)(a.type)}),[a.id,a.type]),o=(0,E.useCallback)(()=>{(0,v.u4)("".concat(v.$x.CARD_FEEDBACK," - ").concat(v.ir.WISE_CARD_FEEDBACK_FORM," - ").concat(v.tc.CLOSED),l),i(!1)},[l]),d=(0,E.useCallback)(()=>{(0,v.u4)("".concat(v.$x.CARD_FEEDBACK," - ").concat(v.ir.WISE_CARD_FEEDBACK_FORM," - ").concat(v.tc.STARTED),l),i(!0)},[l]),u=(0,E.useMemo)(()=>"BUSINESS"===a.type?"Business Debit Card":"Personal Debit Card",[a.type]);return r()?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eK,{onFeedbackClick:d}),(0,s.jsx)(eq,{httpClient:e,open:n,title:t({id:"cards-page.sections.card-feedback.modal.title",defaultMessage:"Help us do better!"}),profileId:a.id,scoreLabel:t({id:"cards-page.sections.card-feedback.modal.score.label",defaultMessage:"How much do you like your Wise card?"}),commentLabel:t({id:"cards-page.sections.card-feedback.modal.comment.label",defaultMessage:"Let us know what you think — is there anything we could do better?"}),scale:{type:"EMOJI",numberOfOptions:5},page:"Cards Page",feature:u,onClose:o})]}):null}function eX(e){let{isYou:t}=e,{formatMessage:a}=(0,c.A)();return(0,s.jsx)(en.A,{type:ei.g.WARNING,className:"m-b-4",children:a(t?{id:"cards-page.alerts.spending-disabled.you",defaultMessage:"Your cards are currently blocked. They can be unblocked by anyone with permission to manage team members."}:{id:"cards-page.alerts.spending-disabled",defaultMessage:"This team member's cards are currently blocked. They can be unblocked by anyone with permission to manage team members."})})}var ez=a(16414),eQ=a(71833),eZ=a(40042);function eJ(e){let{orderCardButtonResponse:{action:t,declineReasons:a},onTrack:r}=e;return(0,E.useEffect)(()=>{null==r||r((0,eZ.s)({base:eZ.b.CARD_PROMOTIONS,action:eZ.a.ORDER_CARD_BUTTON,state:eZ.E.SUCCESS}))},[]),(0,s.jsx)(eQ.N,{action:t,onClick:()=>{"MODAL"===t.action.presentation&&(null==r||r((0,eZ.s)({base:eZ.b.CARD_PROMOTIONS,action:eZ.a.ORDER_CARD_BUTTON,state:eZ.E.INELIGIBLE},{properties:{Reasons:a}})))}})}function e0(){let e=e$(e=>e.orderCardButtonResponse);return e?(0,s.jsx)(eJ,{orderCardButtonResponse:e,onTrack:e=>{let{eventName:t,properties:a,options:r}=e;return(0,v.u4)(t,a,r)}}):null}function e1(e){let{cards:t}=e,a=t.map(e=>{let{token:t}=e;return(0,s.jsx)(ez.C,{card:e,href:"/cards/".concat(t)},t)});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e0,{}),a]})}var e3=a(10230),e2=a.n(e3);function e5(e){let{title:t,className:a,children:r,action:n}=e;return(0,s.jsxs)(g.A,{className:(0,Y.$)("m-b-4",a),children:[(0,s.jsx)(b.Y,{title:t,className:"".concat(e2().styledHeader," p-y-2"),action:n}),r]})}var e4=a(27890),e8=a(50549),e6=a(40439),e7={optionWithButtonsWrapper:"OptionWithButtons-module_optionWithButtonsWrapper__Y2mgC",optionsWithButtonsLayoutContent:"OptionWithButtons-module_optionsWithButtonsLayoutContent__Dy0Xl",optionWithButtonsCardStyleWrapper:"OptionWithButtons-module_optionWithButtonsCardStyleWrapper__L5hdT",optionWithButtonsTextWrapper:"OptionWithButtons-module_optionWithButtonsTextWrapper__aErU3",optionWithButtonsButtonWrapper:"OptionWithButtons-module_optionWithButtonsButtonWrapper__kebqV"};function e9(e){let{media:t,title:a,subtext:r,actionButtons:n,label:i}=e;return(0,s.jsxs)("article",{className:e7.optionWithButtonsWrapper,"aria-label":i,children:[(0,s.jsx)("div",{className:e7.optionWithButtonsCardStyleWrapper,children:t}),(0,s.jsxs)("div",{className:e7.optionsWithButtonsLayoutContent,children:[(0,s.jsxs)("div",{className:e7.optionWithButtonsTextWrapper,children:[(0,s.jsx)(K.A,{type:"body-large-bold",children:a}),r&&(0,s.jsx)(K.A,{children:r})]}),n&&(0,s.jsx)("div",{className:e7.optionWithButtonsButtonWrapper,children:n})]})]})}function te(e){let{cardOrderId:t,groupId:a,media:r,content:n,title:i,...l}=e,o="/cards/order/".concat(t);return(0,s.jsx)(e8.A,{...l,as:"a",href:a?"".concat(o,"?from=groups&groupId=").concat(a):o,"aria-label":n,title:i,content:n,media:r,showMediaCircle:!1})}function tt(e){let{cardOrderId:t,cardOrderStatus:a,canBeCancelled:r,media:n,title:i,content:l,onCancelButtonClick:o}=e,{formatMessage:d}=(0,c.A)(),u="/cards/order/".concat(t,"/resume"),p=(0,E.useMemo)(()=>a!==C.tP.PLACED?null:(0,s.jsx)(P.A,{size:"sm",as:"a",href:u,children:d({id:"twcard-components.card-order-list-item.finish-button",defaultMessage:"Finish"})}),[u,a,d]),m=(0,E.useMemo)(()=>r&&o?(0,s.jsx)(e6.A,{priority:"secondary",onClick:o,children:d({id:"twcard-components.card-order-list-item.cancel-button",defaultMessage:"Cancel"})}):null,[r,d,o]);return(0,s.jsx)(e9,{media:n,title:i,subtext:l,label:l,actionButtons:(0,s.jsxs)(s.Fragment,{children:[p,m]})})}function ta(e){let{cardOrder:t,groupId:a,onCancelButtonClick:r,profileType:n,...i}=e,{cardProgramDetails:{capabilities:l},cancellationDetails:{canBeCancelled:o},status:d,id:c}=t,u=(0,E.useMemo)(()=>(0,s.jsx)(I.Sk,{cardStyle:t.cardProgramDetails.cardStyle,cardStatus:C.vj.INACTIVE}),[t]),p=(0,S.c)({cardOrderStatus:t.status,requirements:t.requirements}),m=(0,S.d)({cardOrderStatus:t.status,cardType:t.cardType,cardProgramStatus:t.cardProgramDetails.programStatus,deliveryEstimate:t.deliveryEstimate,requirements:t.requirements,shippingStartDate:t.shippingStartDate,profileType:n});return(0,e4.i)(l,C.mG.PREACTIVATE)&&r?(0,s.jsx)(tt,{cardOrderId:c,canBeCancelled:o,cardOrderStatus:d,title:p,content:m,media:u,onCancelButtonClick:r}):(0,s.jsx)(te,{...i,cardOrderId:c,groupId:a,title:p,content:m,media:u})}var tr=a(12482);function ts(e){let{cardOrder:t,selectedProfile:a}=e,{push:r}=(0,A.useRouter)(),n=(0,j.r)(e=>e.httpClient),[i,l]=(0,E.useState)(!1);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ta,{cardOrder:t,profileType:a.type,onCancelButtonClick:()=>{l(!0)}}),(0,s.jsx)(tr.s,{isOpen:i,cardOrderId:t.id,httpClient:n,profileId:a.id,onClose:()=>{l(!1)},onOrderCancel:()=>{l(!1),r("/cards/order/".concat(t.id,"/cancel/success?redirectUrl=").concat(encodeURIComponent("/cards")))}})]})}function tn(e){let{cardOrders:t,selectedProfile:a}=e,{formatMessage:r}=(0,c.A)(),n=t.map(e=>(0,s.jsx)(ts,{cardOrder:e,selectedProfile:a},e.id));return(0,s.jsx)(e5,{title:r({id:"cards-page.sections.card-list.title-orders",defaultMessage:"Your orders"}),children:n},"card_order_section")}function ti(){let{httpClient:e}=(0,j.r)(),t=e$(e=>e.userSpendingDisabled),a=(0,p.v)(e=>e.selectedProfile),r=e$(e=>e.cardsInListUi),n=e$(e=>e.cardOrdersInListUi),i=e$(e=>e.isCardListPopulated),{data:l,isSuccess:o}=(0,m.I)({queryKey:["cardPromotionSlide",a.id],queryFn:async()=>(0,ef.g)({httpClient:e,profileId:a.id}),throwOnError:!0,enabled:!i()});return((0,E.useEffect)(()=>{a&&(0,v.u4)("".concat(v.$x.CARD_TAB," - ").concat(v.tc.STARTED),{"Profile Id":a.id,Context:i()?void 0:"Card Promotions"})},[]),i())?(0,s.jsxs)("div",{className:"m-t-2",children:[t&&(0,s.jsx)(eX,{isYou:!0}),(0,s.jsx)(e1,{cards:r}),(0,s.jsx)(tn,{cardOrders:n,selectedProfile:a}),(0,s.jsx)(eH,{})]}):o?(0,s.jsx)(eb.C,{data:l,profileId:a.id,onTrack:e=>{let{eventName:t,properties:a,options:r}=e;return(0,v.u4)(t,a,r)}}):(0,s.jsx)(eg.C,{})}function tl(){let{formatMessage:e}=(0,c.A)();return e$(e=>e.isCardListPopulated)()?(0,s.jsx)(e5,{title:e({id:"cards-page.tabs.your-cards",defaultMessage:"Your cards"}),children:(0,s.jsx)(ti,{})},"card_section"):(0,s.jsx)(ti,{})}function to(){let e=(0,A.useRouter)(),[t,a]=(0,E.useState)(Number(e.query.tab)||0),{formatMessage:r}=(0,c.A)(),{httpClient:n}=(0,j.r)(),{selectedProfile:i}=(0,p.v)(),{canOrderCards:l,canViewActors:o}=(0,x.wn)(),d=L(e=>e.profileActorsAndCards),{data:u}=(0,m.I)({queryKey:["cardAvailability",i.id],queryFn:async()=>l?(0,C.Eu)({httpClient:n,profileId:i.id}):{availableCardPrograms:{cardProgramNames:[],declineReasonCodes:[]}}});if(!u)return(0,s.jsx)("div",{className:"d-flex justify-content-center",children:(0,s.jsx)(h.A,{size:f.o.SMALL})});let N=(0,C.wX)(u.availableCardPrograms.declineReasonCodes);if(l&&!o||N&&0===d.length)return(0,s.jsx)(tl,{});let S=r({id:"cards-page.tabs.team-cards",defaultMessage:"Team cards"});if(!l&&o&&!N)return(0,s.jsxs)(g.A,{children:[(0,s.jsx)(b.Y,{title:S}),(0,s.jsx)(eh,{})]});let I=[{title:r({id:"cards-page.tabs.your-cards",defaultMessage:"Your cards"}),content:(0,s.jsx)(ti,{}),disabled:!1,description:"YOUR_CARDS"},{title:S,content:(0,s.jsx)(eh,{}),disabled:!1,description:"TEAM_CARDS"}];return(0,s.jsx)(y.A,{name:"cards-nav",className:"m-t-2",selected:t,headerWidth:"auto",tabs:I,onTabSelect:r=>{t!==r&&(e.replace({query:{...e.query,tab:r}}),(0,v.u4)("".concat(v.$x.CARD_TAB," - ").concat(v.ir.TAB," - ").concat(v.tc.CHANGED),{Type:I[r].description}),a(r))}})}var td=a(82456),tc=a.n(td),tu=a(38333),tp=a(91189),tm=a.n(tp),th=a(42181),tf=a(39756);let tg=()=>{let e=(0,A.useRouter)();return async t=>{if("INTERNAL"===t.type){var a,r;let{href:s}=t,n=null!==(a=t.as)&&void 0!==a?a:t.href,i=t.query,l=function(e,t){if(0===e.length)return t;if(!t)throw Error("A url with defined slugs must be partnered with query");return Object.keys(t).filter(t=>!e.includes(t)).reduce((e,a)=>({...e,[a]:t[a]}),{})}((null!==(r=s.match(/\[([^\]]+)\]/gu))&&void 0!==r?r:[]).map(e=>{var t;return(null===(t=/\[([^\]]+)\]/u.exec(e))||void 0===t?void 0:t[1])||""}).filter(Boolean),i);return e.push({pathname:s,query:i},{pathname:n,query:l})}let s=t.query&&(0,tf.stringify)(t.query);window.location.href=s?"".concat(t.href,"?").concat(s):t.href}};function tb(){let{formatMessage:e}=(0,c.A)(),t=e$(e=>e.isCardListPopulated),{selectedProfile:a}=(0,p.v)(),r=tg(),{canAddBorderlessAccounts:n}=(0,x.wn)();return n&&t()&&a.type!==l.E.BUSINESS?(0,s.jsx)(th.A,{icon:(0,s.jsx)($.Plus,{}),onClick:async()=>r({href:"/flows/balances/add",type:"EXTERNAL"}),children:e({id:"cards-page.actions.add-money",defaultMessage:"Add money"})}):null}let ty={VIEW_LIMITS:"VIEW_LIMITS"},tx=(0,R.vt)()(e=>({modalState:null,setModalState:t=>{e({modalState:t})}}));var tC=a(8383),tA=a(47354),tE=a(54519),tj=a(73665),tv=a(30244),tN=a(31329);function tS(e){let{spendings:t,loading:a,error:r,shouldShowModal:i,onClose:l}=e,{httpClient:o}=(0,j.r)(),{formatMessage:d}=(0,c.A)(),u=(0,n.jE)(),m=(0,p.v)(e=>e.selectedProfile),h=(0,tE.n)({mutationFn:async e=>{let{spendingType:t,isDefault:a,updatePermissions:r}=e;return(0,tv.I)({httpClient:o,profileId:m.id,command:{isDefault:null!=a&&a,type:t,...r&&r.length>0&&{permissions:r}}})},onSuccess:e=>{u.setQueryData(tC.no.accountSpendings(),t=>null==t?void 0:t.map(t=>{if(t.type===e.type){var a;return{...e,permissions:null!==(a=e.permissions)&&void 0!==a?a:[]}}return t}))}});return(0,s.jsx)(ej.A,{title:d({id:"cards-page.nav-action-bar.limits-modal.title",defaultMessage:"Spending limits"}),body:(0,s.jsx)(tN.A,{children:(0,s.jsx)(tj.L,{error:r,loading:a,spendings:t,updateSpending:async(e,t,a)=>h.mutateAsync({spendingType:e,isDefault:t,updatePermissions:a}).then(()=>{})})}),open:i,size:f.o.MEDIUM,onClose:l})}function tI(){let{formatMessage:e}=(0,c.A)(),t=(0,A.useRouter)(),{modalState:a,setModalState:r}=tx(),{selectedProfile:n,session:{userId:i}}=(0,p.v)(e=>e),{httpClient:l}=(0,j.r)(),{aggregatedProfileLimits:o,aggregatedUserLimits:u,legacyProfileSpendings:m}=(0,tA.a)({httpClient:l,profileId:n.id,userId:i}),h=!!(o&&o.length>0),f=!!(u&&u.length>0),g=!!(m&&m.length>0);if(!h&&!f&&!g)return null;let b=h&&f?tC.Me:tC.P5,y=h||f?async()=>t.push("".concat(b,"?internal=true"),b):()=>r(ty.VIEW_LIMITS),x=e((0,d.Uf)(n)?{id:"cards-page.actions.view-limits",defaultMessage:"View limits"}:{id:"cards-page.actions.edit-limits",defaultMessage:"Edit limits"});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(th.A,{icon:(0,s.jsx)($.Limit,{}),onClick:y,children:x}),!h&&(0,s.jsx)(tS,{shouldShowModal:a===ty.VIEW_LIMITS,error:!1,loading:!1,spendings:m,onClose:()=>r(null)})]})}function tR(){let{hasAnyOfPrivileges:e}=(0,x.wn)(),t=e(tu.fd.canManageCardAccountSpendingLimits,tu.fd.canViewOwnCardSpendingLimits);return(0,s.jsxs)("div",{className:tm().actionListWrapper,children:[t&&(0,s.jsx)(tI,{}),(0,s.jsx)(tb,{})]})}function tO(e){let{profileType:t}=e,{formatMessage:a}=(0,c.A)(),r=e$(e=>e.isCardListPopulated);return t!==l.E.PERSONAL||r()?(0,s.jsxs)("div",{className:tc().cardsContentHeaderWrapper,children:[(0,s.jsx)(o.pb,{as:"h1",title:a({id:"cards-page.cards.section.header",defaultMessage:"Cards"})}),(0,s.jsx)(tR,{})]}):null}function t_(e){let{navigationData:t}=e,{formatMessage:a}=(0,c.A)(),{selectedProfile:r}=(0,p.v)();return(0,s.jsx)(u.M,{navigationData:t,title:(0,s.jsx)(tO,{profileType:r.type}),pageTitle:a({id:"cards-page.page.title",defaultMessage:"Wise - Card"}),children:(0,d.Uf)(r)?(0,s.jsx)(to,{}):(0,s.jsx)(tl,{})})}var tT=a(14368),tD=!0;let tk=e=>{let{userCards:t,userCardOrders:a,navigationData:r,resourceQuery:l,legacyProfileSpendings:o,aggregatedProfileLimits:d,orderCardButtonResponse:c,userId:u,userSpendingStatus:p,profileActorsAndCards:m}=e,h=e$(e=>e.setAllCardsAndCardOrders),f=e$(e=>e.setOrderCardButtonResponse),g=e$(e=>e.setUserSpendingDisabled);h(t,a,u),g(null!=p&&p.spendingDisabled),f(c);let b=L(e=>e.setActorsAndCards);m&&b(m,u);let y=(0,n.jE)(),x=tx(e=>e.setModalState);return o&&y.setQueryDefaults(tC.no.accountSpendings(),{staleTime:3e3,initialData:o}),d&&y.setQueryDefaults(tC.no.profileSpendingLimits(),{staleTime:3e3,enabled:d.length>0,initialData:d}),(0,tT.Kt)(l,[{params:{resource:"limits"},onMatch:()=>x(ty.VIEW_LIMITS)},{params:{resource:"limits",type:e=>e in i.JM},onMatch:()=>x(ty.VIEW_LIMITS)}]),(0,s.jsx)(t_,{navigationData:r})}},10230:e=>{e.exports={styledHeader:"Panel_styledHeader__TcQiB"}},82456:e=>{e.exports={cardsContentHeaderWrapper:"CardsContent_cardsContentHeaderWrapper__HOJq6"}},30939:e=>{e.exports={statusIcon:"SpendingBlockedDescription_statusIcon__oDLIq",description:"SpendingBlockedDescription_description__F3UGc",spendingBlockedTooltipWrapper:"SpendingBlockedDescription_spendingBlockedTooltipWrapper__s1vS6"}},10541:e=>{e.exports={teamCardsEmptyState:"TeamCardsEmptyState_teamCardsEmptyState__VDVb4"}},91189:e=>{e.exports={actionListWrapper:"ActionsSection_actionListWrapper__yFAGO"}},54519:(e,t,a)=>{"use strict";a.d(t,{n:()=>u});var r=a(22155),s=a(59072),n=a(27539),i=a(59994),l=a(64730),o=class extends i.Q{#e;#t=void 0;#a;#r;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#s()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,l.f8)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#a,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,l.EN)(t.mutationKey)!==(0,l.EN)(this.options.mutationKey)?this.reset():this.#a?.state.status==="pending"&&this.#a.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#a?.removeObserver(this)}onMutationUpdate(e){this.#s(),this.#n(e)}getCurrentResult(){return this.#t}reset(){this.#a?.removeObserver(this),this.#a=void 0,this.#s(),this.#n()}mutate(e,t){return this.#r=t,this.#a?.removeObserver(this),this.#a=this.#e.getMutationCache().build(this.#e,this.options),this.#a.addObserver(this),this.#a.execute(e)}#s(){let e=this.#a?.state??(0,s.$)();this.#t={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#n(e){n.j.batch(()=>{if(this.#r&&this.hasListeners()){let t=this.#t.variables,a=this.#t.context;e?.type==="success"?(this.#r.onSuccess?.(e.data,t,a),this.#r.onSettled?.(e.data,null,t,a)):e?.type==="error"&&(this.#r.onError?.(e.error,t,a),this.#r.onSettled?.(void 0,e.error,t,a))}this.listeners.forEach(e=>{e(this.#t)})})}},d=a(72061),c=a(56686);function u(e,t){let a=(0,d.jE)(t),[s]=r.useState(()=>new o(a,e));r.useEffect(()=>{s.setOptions(e)},[s,e]);let i=r.useSyncExternalStore(r.useCallback(e=>s.subscribe(n.j.batchCalls(e)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),l=r.useCallback((e,t)=>{s.mutate(e,t).catch(c.l)},[s]);if(i.error&&(0,c.G)(s.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:l,mutateAsync:i.mutate}}},42181:(e,t,a)=>{"use strict";a.d(t,{A:()=>u});var r=a(70851),s=a(84319),n=a(60492),i=a(70252),l=a(83578);a(22155);var o=a(65723),d=a(68905),c=a(7550);let u=({className:e,children:t,disabled:a,icon:u,onClick:p,priority:m=n.b.PRIMARY,type:h="default"})=>{let f=(0,c.Q)(`(max-width: ${i.E.ZOOM_400}px)`);return(0,o.jsxs)("label",{className:(0,r.$)("np-circular-btn",`np-circular-btn-${m}-${h}`,{"np-circular-btn-disabled":a},e),children:[(0,o.jsx)(d.A,{size:f?32:56,priority:m,type:["accent","positive"].includes(h)?"default":h,className:(0,r.$)("m-b-1"),disabled:a,onClick:p,children:u}),(0,o.jsx)(s.A,{as:"span",className:(0,r.$)("np-circular-btn-label",{disabled:a}),type:l.o.BODY_DEFAULT_BOLD,children:t})]})}},27061:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var r=a(70851),s=a(84319),n=a(65723);let i=({media:e,action:t,className:a,title:i,value:l,isContainerAligned:o,as:d="li",...c})=>(0,n.jsxs)(d,{className:(0,r.$)("np-list-item d-flex align-items-center p-y-2",a,{"p-x-2":!o}),...c,children:[e,(0,n.jsxs)("div",{className:(0,r.$)("d-flex flex-column",{"p-l-2":!!e,"p-r-2":!!t}),children:[(0,n.jsx)(s.A,{type:"body-default",className:"text-secondary m-b-0",children:i}),l&&(0,n.jsx)(s.A,{type:"body-large",className:"text-primary m-b-0",children:l})]}),t?(0,n.jsx)("div",{className:"np-list-item__action m-l-auto",children:t}):null]})},48843:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var r=a(71218),s=a(70851),n=a(84319),i=a(83578);a(22155);var l=a(65723);let o=({className:e,id:t,progress:a})=>(0,l.jsxs)("progress",{id:t,className:(0,s.$)("np-progress d-block",e),...a,children:[Math.floor(a.value/a.max*100),"%"]});var d=a(72993);let c=({className:e,description:t,id:a,title:c,progress:u,textEnd:p})=>{let{isModern:m}=(0,r.D)();return(0,l.jsxs)("div",{className:(0,s.$)("np-progress-bar",e),children:[(0,l.jsxs)("label",{className:"np-progress-bar__title m-b-1",htmlFor:a,children:[(0,l.jsx)(d.A,{type:i.o.TITLE_BODY,className:m?"m-b-1 text-primary":"text-primary",children:c}),t&&(0,l.jsx)(n.A,{children:t})]}),(0,l.jsx)(o,{id:a,progress:u}),(0,l.jsx)(n.A,{as:"p",type:i.o.BODY_DEFAULT_BOLD,className:"d-flex justify-content-end text-primary m-b-0",children:p})]})}},8661:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var r=a(70851),s=a(65723);let n=({as:e="div",children:t,className:a,withHorizontalPadding:n=!1})=>(0,s.jsx)(e,{className:(0,r.$)("np-section",a,{"np-section--with-horizontal-padding":n}),children:t})},7812:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var r=a(22155),s=a(14678);function n(){let{createSnackbar:e}=(0,r.useContext)(s.$);return e}},32373:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});var r=a(70851),s=a(22155),n=a(67978),i=a(86448),l=a(65723);let o=({position:e=i.y.TOP,children:t,label:a,id:o,className:d})=>{let[c,u]=(0,s.useState)(!1),p=(0,s.useRef)(null),[m,h]=(0,s.useState)(null),[f,g]=(0,s.useState)(null),b=(0,s.useId)(),y=o??b,x=[];x.push({name:"arrow",options:{element:m,options:{padding:8}}}),x.push({name:"offset",options:{offset:[0,16]}}),x.push({name:"flip",options:{fallbackPlacements:i.y.TOP}});let{styles:C,attributes:A,forceUpdate:E}=(0,n.E)(p.current,f,{placement:e,modifiers:x});return(0,s.useEffect)(()=>{c&&E&&E()},[c]),(0,l.jsxs)("span",{ref:p,className:"tw-tooltip-container",onMouseOver:()=>u(!0),onFocus:()=>u(!0),onMouseOut:()=>u(!1),onBlur:()=>u(!1),children:[t?(0,s.cloneElement)(t,{"aria-describedby":`${y}-tooltip`}):null,(0,l.jsx)("div",{ref:g,className:(0,r.$)("np-tooltip","np-panel",c?"np-panel--open np-tooltip--open":null,d),style:{...C.popper},...A.popper,"aria-hidden":!c,role:"tooltip",id:`${y}-tooltip`,children:(0,l.jsxs)("div",{className:"np-panel__content tooltip-inner",children:[a,(0,l.jsx)("div",{ref:h,className:(0,r.$)("np-panel__arrow"),style:C.arrow})]})})]})}},34591:(e,t,a)=>{"use strict";a.d(t,{g:()=>s});var r=a(3066);let s=async e=>{let{httpClient:t,profileId:a,balanceId:s}=e,n=function(e){return e?"/v1/profiles/".concat(e,"/bff/cards/card-upsell"):"/v1/bff/cards/card-upsell-no-profile"}(a),{data:i}=await t.get({url:n,upstream:r.U,params:{balanceId:s}});return i}},16414:(e,t,a)=>{"use strict";a.d(t,{C:()=>c});var r=a(65723),s=a(50549),n=a(64405),i=a(51370),l=a(46660),o=a(31982);a(39680);var d=a(31591);function c(e){let{card:t,href:a,hideGroupInSubtitle:c,badge:u,...p}=e,{cardStyle:m,status:h,cardDetails:f,group:g,identifiers:b}=t,y=(0,o.g)(t.program),x=(0,d.u)({lastFourDigits:f.lastFourDigits,cardIdentifiers:b,cardType:y,cardStyle:m}),C=(0,d.a)({expiryDate:f.expiryDate,expiringSoon:f.expiringSoon,cardStatus:h.value,cardGroup:c?void 0:g}),A=(0,d.b)({cardType:y,cardStyle:m,cardDetails:f,cardStatus:h.value,cardGroup:g,cardIdentifiers:b}),E=(0,r.jsx)(l.Sk,{cardStyle:m,cardStatus:h.value});return(0,r.jsx)(s.A,{...p,as:"a","aria-label":A,href:a,media:u?(0,r.jsx)(n.A,{size:i.o.SMALL,badge:u,children:E}):E,title:x,content:C,showMediaCircle:!1})}},29136:(e,t,a)=>{"use strict";a.d(t,{C:()=>c});var r=a(65723),s=a(22155),n=a(71833);a(39680);var i=a(40042),l=a(45582),o=a(50324),d={cardPromotionSlideWrapper:"CardPromotionSlide-module_cardPromotionSlideWrapper__OAiG9"};function c(e){let{data:t,profileId:a,onTrack:n}=e;return((0,s.useEffect)(()=>{"UNAVAILABLE"===t.status&&(null==n||n((0,i.s)({base:i.b.CARD_TAB,state:i.E.UNAVAILABLE},{properties:{Reasons:t.declineReasons,"Profile Id":a,Context:"Card Promotions"}})))},[]),"UNAVAILABLE"===t.status)?(0,r.jsx)(l.C,{cardPromotionUnavailableData:t}):(0,r.jsx)(u,{data:t,profileId:a,onTrack:n})}function u(e){let{data:t,profileId:a,onTrack:l}=e,{title:c,subtitle:u,illustration:p,actions:m}=t;return(0,s.useEffect)(()=>{null==l||l((0,i.s)({base:i.b.CARD_TAB,state:i.E.SUCCESS},{properties:{"Profile Id":a,Context:"Card Promotions"}}))},[]),(0,r.jsx)("div",{className:d.cardPromotionSlideWrapper,children:(0,r.jsx)(o.C,{illustrationName:p,title:c,subtext:u,actions:m.map(e=>(0,r.jsx)(n.B,{action:e},e.content))})})}},74891:(e,t,a)=>{"use strict";a.d(t,{C:()=>r,E:()=>i,c:()=>u});var r,s,n,i,l,o,d=a(37192),c=a(54652);!function(e){e.NEW="NEW",e.REPLACEMENT="REPLACEMENT",e.CANCEL_UNDELIVERED="CANCEL_UNDELIVERED",e.EXPIRY="EXPIRY",e.PENDING="PENDING",e.GROUPS_ONBOARDING="GROUPS_ONBOARDING"}(r||(r={})),function(e){e.NEW="New",e.REPLACEMENT="Replacement",e.CANCEL_UNDELIVERED="Cancel Undelivered",e.EXPIRY="Expiry",e.PENDING="Pending",e.GROUPS_ONBOARDING="Groups Onboarding",e.UNKNOWN="Unknown"}(s||(s={})),s.NEW,s.REPLACEMENT,s.CANCEL_UNDELIVERED,s.EXPIRY,s.GROUPS_ONBOARDING,s.PENDING,function(e){e.PROFILE="Profile",e.ORDER="Order",e.ADDRESS="Delivery Address",e.VERIFICATION="Verification",e.TOPUP="Topup",e.FEE="Fee",e.PIN="Pin",e.CARD_STYLE="Card Style",e.REVIEW="Review",e.BALANCE_LINK="Balance Link"}(n||(n={})),d.qG.ADDRESS,n.ADDRESS,d.qG.VERIFICATION,n.VERIFICATION,d.qG.TOPUP,n.TOPUP,d.qG.FEE,n.FEE,d.qG.PIN,n.PIN,d.qG.CARD_STYLE,n.CARD_STYLE,d.qG.REVIEW,n.REVIEW,d.qG.BALANCE_LINK,n.BALANCE_LINK;let u=e=>{switch(e){case c.E.PERSONAL:return"Personal";case c.E.BUSINESS:return"Business";default:return"Unknown"}};!function(e){e.CARD_TAB="Card Tab",e.CARD_ACTIVATION="Card Activation",e.CARD_TRACKER_MODAL="Card Tracker Modal",e.CARD_ORDER_FLOW="Card Order Flow",e.ORDER_TRACKER="Order Tracker",e.SPEND_PREDELIVERY_NUDGE="Spend Predelivery Nudge",e.SPEND_PREDELIVERY_MODAL="Spend Predelivery Modal",e.EXPIRING_ACTION="Expiring Action",e.EXPIRED_ACTION="Expired Action",e.ORDER_CONTENT="Order Content",e.NONE="None",e.UNKNOWN="Unknown",e.SELF="Self"}(i||(i={})),function(e){e.CARDS="/cards",e.CARDS_TRAILING_SLASH="/cards/",e.CARD_ORDER="/twcard-order/new",e.CARD_ORDER_TRAILING_SLASH="/twcard-order/new/"}(l||(l={})),i.CARD_TAB,i.CARD_TAB,i.CARD_ORDER_FLOW,i.CARD_ORDER_FLOW,function(e){e.VERIFICATION="Verification",e.ADDRESS="Address",e.FEE="Fee",e.TOPUP="Topup",e.PIN="Pin",e.CARD_STYLE="Card Style",e.REVIEW="Review",e.BALANCE_LINK="Balance Link"}(o||(o={})),d.qG.VERIFICATION,o.VERIFICATION,d.qG.ADDRESS,o.ADDRESS,d.qG.FEE,o.FEE,d.qG.TOPUP,o.TOPUP,d.qG.PIN,o.PIN,d.qG.CARD_STYLE,o.CARD_STYLE,d.qG.REVIEW,o.REVIEW,d.qG.BALANCE_LINK,o.BALANCE_LINK}},e=>{var t=t=>e(e.s=t);e.O(0,[2311,193,1766,2877,3189,6367,4212,7978,4138,2419,5627,5005,8352,7606,7117,636,6593,8792],()=>t(30392)),_N_E=e.O()}]);
//# sourceMappingURL=cards-4e8655bd1c30e13a.js.map